<% content_for :javascripts do %>
	<script>
	  var wcgStats,
	      chinese = false;

      $.getJSON('/api/stats/global', function(stats) {
      	wcgStats = stats;
      	if (chinese) {
      		setChinese(stats);
      	} else {
      		setEnglish(stats);
      	}
      });

      function setChinese (stats) {
      	var html = _.template($('#homeTemplateChinese').html(), stats);
        $('#main').html(html);
      }

      function setEnglish (stats) {
      	var html = _.template($('#homeTemplate').html(), stats);
        $('#main').html(html);
      }

      if (chinese) {
        $('header').html(_.template($('#headerTemplateChinese').html()),{});
      } else {
        $('header').html(_.template($('#headerTemplate').html()),{});
      }

      $(document).on('change:language', function(event, language) {
        if (language == 'chinese') {
          chinese = true;
          setChinese(wcgStats);
        } else {
          setEnglish(wcgStats);
        }
      })
	</script>
<% end %>
